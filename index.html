<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề Kiểm Tra Toán 11 - Đề Số 3</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        :root { --primary: #007bff; --success: #28a745; --danger: #dc3545; --light: #f8f9fa; --dark: #343a40; }
        body { font-family: 'Segoe UI', Roboto, Arial, sans-serif; line-height: 1.6; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        .wrapper { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        
        /* Header */
        .exam-header { text-align: center; border-bottom: 3px solid var(--primary); padding-bottom: 20px; margin-bottom: 40px; }
        .exam-header h1 { margin: 0; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        .exam-info { color: #666; margin-top: 10px; font-style: italic; }

        /* Timer Fixed */
        .timer-badge { position: fixed; top: 20px; right: 20px; background: #fff; border: 2px solid var(--danger); color: var(--danger); padding: 10px 20px; border-radius: 30px; font-weight: bold; font-size: 1.2rem; box-shadow: 0 5px 15px rgba(220, 53, 69, 0.2); z-index: 999; }

        /* Sections */
        .section-label { background: var(--dark); color: white; display: inline-block; padding: 8px 15px; border-radius: 5px; margin-top: 30px; margin-bottom: 15px; font-weight: bold; text-transform: uppercase; font-size: 0.9rem; }
        
        /* Questions */
        .q-item { margin-bottom: 25px; background: #fff; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; transition: all 0.3s ease; }
        .q-item:hover { border-color: var(--primary); box-shadow: 0 5px 15px rgba(0,123,255,0.1); }
        .q-text { font-weight: 600; font-size: 1.05rem; display: block; margin-bottom: 15px; }

        /* MCQ Grid */
        .mcq-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        @media (max-width: 600px) { .mcq-grid { grid-template-columns: 1fr; } }
        .mcq-opt { display: flex; align-items: center; padding: 10px; border: 1px solid #dee2e6; border-radius: 6px; cursor: pointer; transition: background 0.2s; }
        .mcq-opt:hover { background-color: #e9ecef; }
        .mcq-opt input { margin-right: 12px; transform: scale(1.2); }

        /* True/False Table */
        .tf-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .tf-table th, .tf-table td { border: 1px solid #dee2e6; padding: 12px; }
        .tf-table th { background-color: #f8f9fa; text-align: center; width: 15%; }
        .tf-table td:first-child { width: 70%; font-weight: 500; }
        .tf-check { display: flex; justify-content: center; }
        .tf-check input { transform: scale(1.3); cursor: pointer; }

        /* Short Answer Input */
        .sa-input { width: 100%; max-width: 250px; padding: 10px; border: 2px solid #ced4da; border-radius: 5px; font-size: 1rem; transition: border-color 0.3s; }
        .sa-input:focus { border-color: var(--primary); outline: none; }

        /* Feedback & Result */
        .feedback { margin-top: 15px; padding: 15px; border-radius: 6px; font-size: 0.95rem; background-color: #f8f9fa; border-left: 4px solid #6c757d; display: none; }
        .feedback.correct { border-color: var(--success); background-color: #d4edda; color: #155724; }
        .feedback.wrong { border-color: var(--danger); background-color: #f8d7da; color: #721c24; }
        
        .result-box { text-align: center; padding: 30px; background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); border-radius: 10px; margin-bottom: 30px; display: none; }
        .result-score { font-size: 3rem; font-weight: bold; color: #333; margin: 10px 0; }

        /* Button */
        .btn-finish { display: block; width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 1.2rem; font-weight: bold; cursor: pointer; margin-top: 40px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: transform 0.2s; }
        .btn-finish:hover { background: #0056b3; transform: translateY(-2px); }

    </style>
</head>
<body>

<div class="timer-badge" id="timer">45:00</div>

<div class="wrapper">
    <div class="exam-header">
        <h1>ĐỀ KIỂM TRA HỌC KỲ 1 - TOÁN 11 (ĐỀ 3)</h1>
        <div class="exam-info">Thời gian: 45 phút | Cấu trúc Ma trận Đặc tả Mới</div>
    </div>

    <div class="result-box" id="resultBox">
        <h2>KẾT QUẢ BÀI LÀM</h2>
        <div class="result-score" id="scoreDisplay">0.0</div>
        <p id="resultMsg">Hãy xem lại chi tiết lời giải bên dưới.</p>
        <button onclick="location.reload()" style="padding:10px 20px; border:none; border-radius:5px; cursor:pointer;">Làm lại đề này</button>
    </div>

    <form id="quizForm">
        <div class="section-label">PHẦN I: TRẮC NGHIỆM (3.0 Điểm)</div>

        <div class="q-item" id="q1">
            <span class="q-text">Câu 1: Cho góc \(\alpha\) thỏa mãn \(\frac{\pi}{2} < \alpha < \pi\). Khẳng định nào sau đây đúng?</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q1" value="A"> A. \(\sin\alpha > 0, \cos\alpha > 0\)</label>
                <label class="mcq-opt"><input type="radio" name="q1" value="B"> B. \(\sin\alpha > 0, \cos\alpha < 0\)</label>
                <label class="mcq-opt"><input type="radio" name="q1" value="C"> C. \(\sin\alpha < 0, \cos\alpha > 0\)</label>
                <label class="mcq-opt"><input type="radio" name="q1" value="D"> D. \(\sin\alpha < 0, \cos\alpha < 0\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: B</b>. Góc phần tư thứ II thì sin dương, cos âm.</div>
        </div>

        <div class="q-item" id="q2">
            <span class="q-text">Câu 2: Nghiệm của phương trình \(2\sin x - 1 = 0\) là:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q2" value="A"> A. \(x = \pm \frac{\pi}{6} + k2\pi\)</label>
                <label class="mcq-opt"><input type="radio" name="q2" value="B"> B. \(x = \frac{\pi}{6} + k2\pi; x = \frac{5\pi}{6} + k2\pi\)</label>
                <label class="mcq-opt"><input type="radio" name="q2" value="C"> C. \(x = \frac{\pi}{3} + k2\pi\)</label>
                <label class="mcq-opt"><input type="radio" name="q2" value="D"> D. \(x = \frac{\pi}{6} + k\pi\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: B</b>. \(\sin x = 1/2 \Rightarrow x = \pi/6\) hoặc \(x = \pi - \pi/6\).</div>
        </div>

        <div class="q-item" id="q3">
            <span class="q-text">Câu 3: Dãy số nào sau đây là dãy số tăng?</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q3" value="A"> A. \(u_n = \frac{1}{n}\)</label>
                <label class="mcq-opt"><input type="radio" name="q3" value="B"> B. \(u_n = -2n + 1\)</label>
                <label class="mcq-opt"><input type="radio" name="q3" value="C"> C. \(u_n = n^2 + 1\)</label>
                <label class="mcq-opt"><input type="radio" name="q3" value="D"> D. \(u_n = (-1)^n\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: C</b>. \(u_{n+1} - u_n > 0\) với mọi \(n \ge 1\).</div>
        </div>

        <div class="q-item" id="q4">
            <span class="q-text">Câu 4: Cho cấp số cộng \((u_n)\) biết \(u_1 = -1\), \(u_{10} = 17\). Công sai \(d\) bằng:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q4" value="A"> A. 2</label>
                <label class="mcq-opt"><input type="radio" name="q4" value="B"> B. 3</label>
                <label class="mcq-opt"><input type="radio" name="q4" value="C"> C. 1.8</label>
                <label class="mcq-opt"><input type="radio" name="q4" value="D"> D. -2</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: A</b>. \(u_{10} = u_1 + 9d \Rightarrow 17 = -1 + 9d \Rightarrow 9d=18 \Rightarrow d=2\).</div>
        </div>

        <div class="q-item" id="q5">
            <span class="q-text">Câu 5: Cho cấp số nhân \((u_n)\) với \(u_n = 2 \cdot 3^{n}\). Công bội \(q\) là:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q5" value="A"> A. 2</label>
                <label class="mcq-opt"><input type="radio" name="q5" value="B"> B. 3</label>
                <label class="mcq-opt"><input type="radio" name="q5" value="C"> C. 6</label>
                <label class="mcq-opt"><input type="radio" name="q5" value="D"> D. 9</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: B</b>. Dạng tổng quát \(u_n = u_1 \cdot q^{n-1}\) hoặc kiểm tra tỉ số \(u_{n+1}/u_n = 3\).</div>
        </div>

        <div class="q-item" id="q6">
            <span class="q-text">Câu 6: \(\lim_{x \to 1} \frac{x^2 - 1}{x - 1}\) bằng:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q6" value="A"> A. 0</label>
                <label class="mcq-opt"><input type="radio" name="q6" value="B"> B. 1</label>
                <label class="mcq-opt"><input type="radio" name="q6" value="C"> C. 2</label>
                <label class="mcq-opt"><input type="radio" name="q6" value="D"> D. \(\infty\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: C</b>. Rút gọn \((x-1)(x+1)/(x-1) = x+1 \to 2\).</div>
        </div>

        <div class="q-item" id="q7">
            <span class="q-text">Câu 7: Hàm số \(y = \frac{2x+1}{x-3}\) gián đoạn tại điểm nào?</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q7" value="A"> A. \(x = -1/2\)</label>
                <label class="mcq-opt"><input type="radio" name="q7" value="B"> B. \(x = 0\)</label>
                <label class="mcq-opt"><input type="radio" name="q7" value="C"> C. \(x = 3\)</label>
                <label class="mcq-opt"><input type="radio" name="q7" value="D"> D. \(x = 1\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: C</b>. Hàm phân thức gián đoạn khi mẫu bằng 0.</div>
        </div>

        <div class="q-item" id="q8">
            <span class="q-text">Câu 8: Trong không gian, hai mặt phẳng song song là hai mặt phẳng:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q8" value="A"> A. Không có điểm chung.</label>
                <label class="mcq-opt"><input type="radio" name="q8" value="B"> B. Có đúng 1 điểm chung.</label>
                <label class="mcq-opt"><input type="radio" name="q8" value="C"> C. Có vô số điểm chung.</label>
                <label class="mcq-opt"><input type="radio" name="q8" value="D"> D. Chứa hai đường thẳng song song.</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: A</b>. Định nghĩa: Hai mặt phẳng song song không có điểm chung.</div>
        </div>

        <div class="q-item" id="q9">
            <span class="q-text">Câu 9: Cho tứ diện \(ABCD\). Gọi \(M, N\) là trung điểm \(AB, AC\). Đường thẳng \(MN\) song song với mặt phẳng nào?</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q9" value="A"> A. \((ABC)\)</label>
                <label class="mcq-opt"><input type="radio" name="q9" value="B"> B. \((ABD)\)</label>
                <label class="mcq-opt"><input type="radio" name="q9" value="C"> C. \((BCD)\)</label>
                <label class="mcq-opt"><input type="radio" name="q9" value="D"> D. \((ACD)\)</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: C</b>. \(MN\) là đường trung bình tam giác \(ABC \Rightarrow MN // BC\). Mà \(BC \subset (BCD)\) nên \(MN // (BCD)\).</div>
        </div>

        <div class="q-item" id="q10">
            <span class="q-text">Câu 10: Cho mẫu số liệu ghép nhóm: [0;20): 10, [20;40): 20, [40;60): 15. Nhóm chứa Mốt là:</span>
            <div class="mcq-grid">
                <label class="mcq-opt"><input type="radio" name="q10" value="A"> A. [0; 20)</label>
                <label class="mcq-opt"><input type="radio" name="q10" value="B"> B. [20; 40)</label>
                <label class="mcq-opt"><input type="radio" name="q10" value="C"> C. [40; 60)</label>
                <label class="mcq-opt"><input type="radio" name="q10" value="D"> D. Cả 3 nhóm</label>
            </div>
            <div class="feedback"><b>Đáp án đúng: B</b>. Nhóm có tần số lớn nhất (20).</div>
        </div>

        <div class="section-label">PHẦN II: ĐÚNG / SAI (4.0 Điểm)</div>

        <div class="q-item" id="tf1">
            <span class="q-text">Câu 1: Cho phương trình lượng giác \(\tan\left(x + \frac{\pi}{3}\right) = 1\).</span>
            <table class="tf-table">
                <thead><tr><th>Mệnh đề</th><th>Đúng</th><th>Sai</th></tr></thead>
                <tbody>
                    <tr data-ans="T">
                        <td>a) Điều kiện xác định là \(x \neq \frac{\pi}{6} + k\pi\).</td>
                        <td class="tf-check"><input type="radio" name="tf1a" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf1a" value="F"></td>
                    </tr>
                    <tr data-ans="F">
                        <td>b) Phương trình tương đương \(\tan\left(x + \frac{\pi}{3}\right) = \tan\frac{\pi}{6}\).</td>
                        <td class="tf-check"><input type="radio" name="tf1b" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf1b" value="F"></td>
                    </tr>
                    <tr data-ans="T">
                        <td>c) Nghiệm của phương trình là \(x = -\frac{\pi}{12} + k\pi\).</td>
                        <td class="tf-check"><input type="radio" name="tf1c" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf1c" value="F"></td>
                    </tr>
                    <tr data-ans="F">
                        <td>d) Phương trình có 2 nghiệm thuộc khoảng \((0; \pi)\).</td>
                        <td class="tf-check"><input type="radio" name="tf1d" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf1d" value="F"></td>
                    </tr>
                </tbody>
            </table>
            <div class="feedback">
                <b>Giải thích:</b><br>
                - a) Đúng. \(x+\pi/3 \neq \pi/2 + k\pi \Rightarrow x \neq \pi/6\).<br>
                - b) Sai. \(1 = \tan(\pi/4)\).<br>
                - c) Đúng. \(x+\pi/3 = \pi/4 + k\pi \Rightarrow x = -\pi/12 + k\pi\).<br>
                - d) Sai. Trong \((0; \pi)\) chỉ có nghiệm \(x = -\pi/12 + \pi = 11\pi/12\) (1 nghiệm).
            </div>
        </div>

        <div class="q-item" id="tf2">
            <span class="q-text">Câu 2: Một người gửi tiết kiệm 100 triệu đồng, lãi suất 6%/năm theo hình thức lãi kép (tiền lãi nhập vào gốc). Gọi \(T_n\) là số tiền nhận được sau \(n\) năm.</span>
            <table class="tf-table">
                <thead><tr><th>Mệnh đề</th><th>Đúng</th><th>Sai</th></tr></thead>
                <tbody>
                    <tr data-ans="T">
                        <td>a) Dãy số \((T_n)\) là một cấp số nhân.</td>
                        <td class="tf-check"><input type="radio" name="tf2a" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf2a" value="F"></td>
                    </tr>
                    <tr data-ans="T">
                        <td>b) Công bội của cấp số nhân là \(q = 1,06\).</td>
                        <td class="tf-check"><input type="radio" name="tf2b" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf2b" value="F"></td>
                    </tr>
                    <tr data-ans="F">
                        <td>c) Số tiền sau 1 năm là 105 triệu đồng.</td>
                        <td class="tf-check"><input type="radio" name="tf2c" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf2c" value="F"></td>
                    </tr>
                    <tr data-ans="T">
                        <td>d) Công thức tính tiền sau \(n\) năm là \(T_n = 100 \cdot (1,06)^n\).</td>
                        <td class="tf-check"><input type="radio" name="tf2d" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf2d" value="F"></td>
                    </tr>
                </tbody>
            </table>
            <div class="feedback">
                <b>Giải thích:</b><br>
                - c) Sai. \(100 \times 1.06 = 106\) triệu.
            </div>
        </div>

        <div class="q-item" id="tf3">
            <span class="q-text">Câu 3: Cho hình chóp \(S.ABCD\) có đáy là hình thang (\(AB // CD\), \(AB > CD\)).</span>
            <table class="tf-table">
                <thead><tr><th>Mệnh đề</th><th>Đúng</th><th>Sai</th></tr></thead>
                <tbody>
                    <tr data-ans="T">
                        <td>a) Giao tuyến của \((SAB)\) và \((SCD)\) là đường thẳng đi qua \(S\) và song song với \(AB\).</td>
                        <td class="tf-check"><input type="radio" name="tf3a" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf3a" value="F"></td>
                    </tr>
                    <tr data-ans="F">
                        <td>b) Đường thẳng \(CD\) cắt mặt phẳng \((SAB)\).</td>
                        <td class="tf-check"><input type="radio" name="tf3b" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf3b" value="F"></td>
                    </tr>
                    <tr data-ans="T">
                        <td>c) Đường thẳng \(CD\) song song với mặt phẳng \((SAB)\).</td>
                        <td class="tf-check"><input type="radio" name="tf3c" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf3c" value="F"></td>
                    </tr>
                    <tr data-ans="F">
                        <td>d) \(AB\) và \(CD\) chéo nhau.</td>
                        <td class="tf-check"><input type="radio" name="tf3d" value="T"></td>
                        <td class="tf-check"><input type="radio" name="tf3d" value="F"></td>
                    </tr>
                </tbody>
            </table>
            <div class="feedback">
                <b>Giải thích:</b><br>
                - b) Sai. \(CD // AB\) và \(AB \subset (SAB) \Rightarrow CD // (SAB)\).<br>
                - d) Sai. \(AB, CD\) cùng nằm trong đáy nên chúng song song, không chéo nhau.
            </div>
        </div>

        <div class="section-label">PHẦN III: TRẢ LỜI NGẮN (3.0 Điểm)</div>

        <div class="q-item" id="sa1">
            <span class="q-text">Câu 1: Tính giới hạn \(L = \lim \frac{\sqrt{n^2 + 2n} - n}{2}\). (Kết quả viết dưới dạng số thập phân).</span>
            <input type="number" step="0.1" class="sa-input" id="input_sa1" placeholder="Nhập kết quả...">
            <div class="feedback"><b>Đáp án: 0.5</b>. <br> Nhân liên hợp: \(\sqrt{n^2+2n}-n = \frac{2n}{\sqrt{n^2+2n}+n} \to \frac{2n}{2n} = 1\). Vậy \(L = 1/2 = 0.5\).</div>
        </div>

        <div class="q-item" id="sa2">
            <span class="q-text">Câu 2: Một hồ chứa nước đang có 10.000 \(m^3\) nước. Mỗi ngày lượng nước bốc hơi mất 5% so với ngày trước đó. Hỏi sau 10 ngày, lượng nước còn lại là bao nhiêu \(m^3\)? (Làm tròn đến hàng đơn vị).</span>
            <input type="number" class="sa-input" id="input_sa2" placeholder="Nhập số nguyên...">
            <div class="feedback"><b>Đáp án: 5987</b>. <br> Cấp số nhân \(u_n = 10000 \cdot (0.95)^{10} \approx 5987\).</div>
        </div>

        <div class="q-item" id="sa3">
            <span class="q-text">Câu 3: Cho hình hộp \(ABCD.A'B'C'D'\). Biết diện tích tam giác \(AB'D'\) bằng 12 \(cm^2\). Tính diện tích tam giác \(BC'D\) theo \(cm^2\).</span>
            <input type="number" class="sa-input" id="input_sa3" placeholder="Nhập diện tích...">
            <div class="feedback"><b>Đáp án: 12</b>. <br> Các tam giác \(AB'D'\) và \(BC'D\) là các tam giác bằng nhau (các cạnh là đường chéo các mặt bên bằng nhau).</div>
        </div>

        <button type="button" class="btn-finish" onclick="submitExam()">NỘP BÀI VÀ XEM ĐIỂM</button>
    </form>
</div>

<script>
    // --- TIMER ---
    let timeSeconds = 45 * 60;
    const timerDisplay = document.getElementById('timer');
    
    const interval = setInterval(() => {
        const m = Math.floor(timeSeconds / 60);
        const s = timeSeconds % 60;
        timerDisplay.textContent = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
        timeSeconds--;

        if (timeSeconds < 0) {
            clearInterval(interval);
            alert("Hết giờ làm bài!");
            submitExam();
        }
    }, 1000);

    // --- GRADING ---
    function submitExam() {
        clearInterval(interval);
        let score = 0;

        // 1. MCQ (0.3đ / câu)
        const keyMCQ = { q1:'B', q2:'B', q3:'C', q4:'A', q5:'B', q6:'C', q7:'C', q8:'A', q9:'C', q10:'B' };
        for (let q in keyMCQ) {
            const userAns = document.querySelector(`input[name="${q}"]:checked`);
            const div = document.getElementById(q);
            const feed = div.querySelector('.feedback');
            feed.style.display = 'block';

            if (userAns && userAns.value === keyMCQ[q]) {
                score += 0.3;
                div.style.borderLeft = "5px solid var(--success)";
                feed.classList.add('correct');
            } else {
                div.style.borderLeft = "5px solid var(--danger)";
                feed.classList.add('wrong');
            }
        }

        // 2. TRUE/FALSE (Total 4.0đ -> ~1.33đ / câu lớn)
        // Cách tính điểm đơn giản: Mỗi ý nhỏ đúng được 0.33đ.
        const keyTF = {
            tf1: ['T', 'F', 'T', 'F'],
            tf2: ['T', 'T', 'F', 'T'],
            tf3: ['T', 'F', 'T', 'F']
        };

        for (let qID in keyTF) {
            const rows = document.querySelectorAll(`#${qID} tbody tr`);
            const feed = document.querySelector(`#${qID} .feedback`);
            feed.style.display = 'block';
            let correctCount = 0;

            rows.forEach((row, index) => {
                const userT = row.querySelector('input[value="T"]').checked;
                const userF = row.querySelector('input[value="F"]').checked;
                const correctVal = keyTF[qID][index]; // 'T' or 'F'

                let userVal = userT ? 'T' : (userF ? 'F' : null);
                
                if (userVal === correctVal) {
                    correctCount++;
                    row.style.background = "#d4edda";
                } else {
                    row.style.background = "#f8d7da";
                }
            });

            // Cộng điểm: (4 điểm tổng / 12 ý nhỏ) ~ 0.333 điểm mỗi ý
            score += correctCount * (4.0 / 12.0);
        }

        // 3. SHORT ANSWER (1.0đ / câu)
        const keySA = {
            input_sa1: 0.5,
            input_sa2: 5987,
            input_sa3: 12
        };

        for (let id in keySA) {
            const input = document.getElementById(id);
            const div = document.getElementById(id.replace('input_', ''));
            const feed = div.querySelector('.feedback');
            feed.style.display = 'block';
            
            let val = parseFloat(input.value);
            
            // Chấp nhận sai số nhỏ
            if (Math.abs(val - keySA[id]) < 0.1) {
                score += 1.0;
                div.style.borderLeft = "5px solid var(--success)";
                feed.classList.add('correct');
            } else {
                div.style.borderLeft = "5px solid var(--danger)";
                feed.classList.add('wrong');
            }
        }

        // HIỂN THỊ KẾT QUẢ
        const resultBox = document.getElementById('resultBox');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const resultMsg = document.getElementById('resultMsg');
        
        resultBox.style.display = 'block';
        scoreDisplay.textContent = score.toFixed(1) + " / 10";
        
        if (score >= 8.0) resultMsg.textContent = "Tuyệt vời! Kiến thức của bạn rất vững.";
        else if (score >= 5.0) resultMsg.textContent = "Khá tốt! Hãy ôn lại các câu làm sai.";
        else resultMsg.textContent = "Cần cố gắng nhiều hơn ở lần sau nhé!";

        window.scrollTo(0,0);
        
        // Disable inputs
        document.querySelectorAll('input').forEach(i => i.disabled = true);
        document.querySelector('.btn-finish').style.display = 'none';
    }
</script>

</body>
</html>
